//
//  main.swift
//  ptcg_calculator
//
//  Created by Yuu on 2025/1/1.
//

import Foundation

//皮卡丘
//寶石海星
//沙奈朵牌組

//幻之石板
//紅卡

let debug_flags = Array(repeating: true, count: 1)
//let debug_flags = [false, true, false, true]
//let debug_flags = [false, true, true]
func debug_msg(_ 玩家: 寶可夢玩家, _ flagIndex: Int, _ array: String...) {
    guard debug_flags[safe: flagIndex] == true else { return }
    print("\(玩家.先手玩家 ? "先手" : "後手") : " + array.joined(separator: ", "))
    
    if //玩家.先手玩家,
       debug_flags[safe: 3] == true
    {
        print("\(玩家.先手玩家 ? "先手" : "後手") : " + 玩家.牌堆資訊())
    }
}

func main() {
    let startTime = Date()
    
    
    let model = 模擬抽皮卡丘EX()
    //let model = 模擬抽寶石海星()
    //let model = 模擬抽沙奈朵()
    //let model = 模擬用紅卡();model.調整紅卡玩家基礎寶可夢(6)
    //let model = 模擬抽沙奈朵()
    model.設定雜牌基礎寶可夢數量範圍(2...6)
    model.設定所有出牌策略([])
    //let result = model.loop(1_000_000)
    let result = model.loop(20_000)
    //let result = model.loop(300)
    //let result = model.loop(1)
    
    result.first!.顯示結果(.表格)
    
    //實體測試者.執行所有測試()
    //回合統計表.執行所有測試()
    
    let endTime = Date(); let costTime = Int(endTime.timeIntervalSince(startTime).rounded())
    print("花費時間: \(costTime) 秒")
    let tableArray = jsonArray.map({回合統計表(json: $0)!})
    tableArray[2].顯示結果(.表格)
    //tableArray.印出JSON("jsonArray")
//    for table in tableArray {
//        table.顯示結果()
//    }
    
    //TODO
//    result[0].顯示結果(.表格)
//    tableArray[2].顯示結果(.表格)
//    let newArray = 回合統計表.合併(tableArray + result)
//    print("newArray[\(newArray.count)]")
//    newArray[2].顯示結果(.表格)
    //TODO
    
    //TODO
    //result.first!.顯示比較結果(比較: tableArray[2])
    //TODO
}
main()

//皮卡丘EX[300, 000], 精靈球 > 大木博士
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 |
//| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.4 | 1.6 | 3.5 | 6.1 | 9.4 | 12.9 | 16.9 | 21.3 | 25.5 | 29.5 | 33.4 | 37.2 | 40.2 |
//| 1 | 13.6 | 24.1 | 34.6 | 44.1 | 52.1 | 58.2 | 62.5 | 65.4 | 66.8 | 66.8 | 66.4 | 65.8 | 64.9 |
//| 2 | 24.3 | 40.7 | 54.8 | 64.9 | 71.6 | 75.3 | 76.9 | 77.5 | 77.1 | 76.3 | 75.5 | 75.0 | 74.3 |
//| 3 | 35.3 | 55.5 | 70.2 | 78.7 | 83.0 | 84.6 | 84.6 | 84.2 | 83.5 | 82.7 | 82.2 | 81.8 | 81.1 |
//| 4 | 47.3 | 69.6 | 82.6 | 88.4 | 90.4 | 90.5 | 90.0 | 89.4 | 88.7 | 88.2 | 87.8 | 87.3 | 86.9 |
//| 5 | 60.0 | 81.4 | 91.3 | 94.4 | 94.8 | 94.4 | 93.9 | 93.4 | 92.9 | 92.6 | 92.2 | 91.9 | 91.6 |
//| 6 | 72.0 | 90.4 | 96.5 | 97.6 | 97.5 | 97.1 | 96.7 | 96.4 | 96.1 | 95.9 | 95.7 | 95.5 | 95.3 |
//| 7 | 83.0 | 96.2 | 99.0 | 99.1 | 99.0 | 98.8 | 98.6 | 98.4 | 98.3 | 98.2 | 98.1 | 98.0 | 97.9 |
//| 8 | 91.9 | 99.1 | 99.8 | 99.8 | 99.8 | 99.7 | 99.7 | 99.6 | 99.6 | 99.6 | 99.5 | 99.5 | 99.5 |
//| 9 | 98.1 | 99.9 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 99.9 | 99.9 | 99.9 | 99.9 | 99.9 |
//| 10 | 99.8 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//
//皮卡丘EX[300, 000], 大木博士 > 精靈球
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 |
//| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.4 | 1.5 | 3.5 | 6.1 | 9.2 | 13.0 | 17.1 | 21.1 | 25.4 | 29.6 | 33.5 | 37.2 | 40.2 |
//| 1 | 14.8 | 25.1 | 35.3 | 44.8 | 52.7 | 58.6 | 63.0 | 65.6 | 66.8 | 67.0 | 66.4 | 65.8 | 65.1 |
//| 2 | 25.5 | 41.7 | 55.2 | 65.4 | 71.9 | 75.5 | 77.3 | 77.5 | 77.1 | 76.3 | 75.5 | 75.0 | 74.4 |
//| 3 | 36.3 | 56.2 | 70.5 | 79.1 | 83.3 | 84.7 | 84.8 | 84.3 | 83.6 | 82.8 | 82.1 | 81.7 | 81.2 |
//| 4 | 48.3 | 70.0 | 82.8 | 88.7 | 90.6 | 90.6 | 90.1 | 89.5 | 88.8 | 88.2 | 87.6 | 87.3 | 86.9 |
//| 5 | 60.6 | 81.8 | 91.3 | 94.5 | 95.0 | 94.4 | 93.9 | 93.5 | 93.0 | 92.6 | 92.2 | 92.0 | 91.6 |
//| 6 | 72.7 | 90.6 | 96.4 | 97.6 | 97.5 | 97.1 | 96.8 | 96.5 | 96.2 | 96.0 | 95.7 | 95.5 | 95.3 |
//| 7 | 83.4 | 96.3 | 98.9 | 99.2 | 99.0 | 98.8 | 98.6 | 98.5 | 98.3 | 98.3 | 98.1 | 98.0 | 97.9 |
//| 8 | 92.1 | 99.1 | 99.8 | 99.8 | 99.8 | 99.7 | 99.7 | 99.6 | 99.6 | 99.6 | 99.5 | 99.5 | 99.5 |
//| 9 | 98.1 | 99.9 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 99.9 | 99.9 | 99.9 | 99.9 | 99.9 |
//| 10 | 99.8 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |



//沙奈朵[3000], 精靈球 > 大木博士 > 幻之石板
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
//| --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 48.9 | 47.0 | 43.2 | 42.0 | 39.9 | 40.4 | 39.0 |
//| 4 | 62.5 | 61.4 | 59.5 | 56.2 | 55.6 | 56.8 | 54.6 |
//| 5 | 74.5 | 73.9 | 73.0 | 69.6 | 70.7 | 71.1 | 68.5 |
//| 6 | 84.2 | 84.8 | 84.6 | 83.3 | 82.8 | 83.1 | 81.4 |
//| 7 | 92.3 | 92.2 | 92.2 | 92.0 | 91.1 | 92.0 | 91.3 |
//| 8 | 97.0 | 97.3 | 97.4 | 96.9 | 96.4 | 97.4 | 96.2 |
//| 9 | 99.2 | 99.1 | 99.5 | 99.2 | 99.2 | 99.4 | 99.0 |
//| 10 | 99.8 | 99.9 | 99.9 | 99.8 | 99.9 | 99.9 | 99.8 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//| 12 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//
//沙奈朵[3000], 精靈球 > 幻之石板 > 大木博士
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
//| --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 48.8 | 46.4 | 41.0 | 41.8 | 40.5 | 37.9 | 39.3 |
//| 4 | 62.7 | 61.1 | 56.3 | 57.4 | 56.5 | 54.2 | 54.7 |
//| 5 | 75.4 | 74.0 | 71.3 | 71.2 | 69.4 | 69.1 | 68.5 |
//| 6 | 85.9 | 84.4 | 83.6 | 83.0 | 81.6 | 82.0 | 81.3 |
//| 7 | 92.9 | 92.6 | 91.9 | 90.5 | 91.5 | 91.1 | 90.6 |
//| 8 | 97.3 | 96.8 | 96.9 | 95.8 | 96.8 | 96.5 | 96.6 |
//| 9 | 99.3 | 99.1 | 99.2 | 99.2 | 99.2 | 99.1 | 98.8 |
//| 10 | 99.9 | 99.8 | 99.9 | 99.8 | 99.9 | 99.8 | 99.8 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//
//沙奈朵[3000], 大木博士 > 精靈球 > 幻之石板
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
//| --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 46.6 | 46.0 | 43.1 | 42.4 | 39.4 | 38.6 | 39.8 |
//| 4 | 62.4 | 59.9 | 57.7 | 57.6 | 54.9 | 55.0 | 55.8 |
//| 5 | 74.7 | 74.1 | 71.1 | 71.8 | 69.9 | 69.7 | 69.3 |
//| 6 | 85.1 | 84.4 | 83.9 | 84.1 | 82.7 | 82.4 | 81.5 |
//| 7 | 92.9 | 92.5 | 92.2 | 91.8 | 91.7 | 91.5 | 90.2 |
//| 8 | 97.0 | 97.2 | 96.9 | 96.8 | 97.0 | 97.0 | 96.1 |
//| 9 | 99.1 | 99.0 | 99.0 | 99.3 | 99.2 | 99.1 | 98.8 |
//| 10 | 99.9 | 99.8 | 99.9 | 99.9 | 99.9 | 99.7 | 99.8 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 99.9 |
//| 12 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//
//沙奈朵[3000], 大木博士 > 幻之石板 > 精靈球
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
//| --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 47.0 | 43.2 | 42.2 | 41.8 | 39.0 | 39.2 | 37.4 |
//| 4 | 63.4 | 58.3 | 58.0 | 56.9 | 54.1 | 53.9 | 53.1 |
//| 5 | 75.2 | 71.5 | 71.0 | 70.0 | 68.3 | 68.4 | 67.6 |
//| 6 | 85.5 | 83.4 | 81.4 | 83.0 | 81.0 | 80.6 | 81.1 |
//| 7 | 93.0 | 91.7 | 91.5 | 91.3 | 90.3 | 90.6 | 90.7 |
//| 8 | 97.4 | 96.6 | 96.5 | 96.6 | 96.0 | 96.4 | 96.4 |
//| 9 | 99.2 | 99.1 | 99.1 | 99.1 | 99.0 | 98.7 | 98.9 |
//| 10 | 99.9 | 99.9 | 99.9 | 99.9 | 99.8 | 99.8 | 99.9 |
//| 11 | 100.0 | 100.0 | 99.9 | 100.0 | 100.0 | 100.0 | 100.0 |
//| 12 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//
//沙奈朵[3000], 幻之石板 > 精靈球 > 大木博士
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
//| --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 47.9 | 44.8 | 43.4 | 39.1 | 41.3 | 40.8 | 37.9 |
//| 4 | 61.9 | 59.2 | 59.2 | 54.5 | 56.9 | 56.3 | 52.7 |
//| 5 | 74.8 | 72.2 | 72.4 | 69.0 | 70.3 | 70.7 | 66.8 |
//| 6 | 85.9 | 83.7 | 84.2 | 82.0 | 82.2 | 82.8 | 79.6 |
//| 7 | 92.8 | 92.0 | 92.0 | 91.0 | 90.9 | 91.7 | 90.4 |
//| 8 | 97.3 | 96.8 | 97.4 | 96.3 | 96.3 | 96.5 | 95.9 |
//| 9 | 99.0 | 99.0 | 99.3 | 99.1 | 98.9 | 98.9 | 98.8 |
//| 10 | 99.8 | 99.9 | 99.8 | 99.8 | 99.8 | 99.8 | 99.8 |
//| 11 | 100.0 | 100.0 | 99.9 | 100.0 | 100.0 | 100.0 | 100.0 |
//| 12 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//
//沙奈朵[3000], 幻之石板 > 大木博士 > 精靈球
//|  | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
//| --- | --- | --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 47.3 | 46.3 | 43.3 | 41.2 | 40.4 | 40.0 | 39.2 |
//| 4 | 61.2 | 60.7 | 58.0 | 56.8 | 55.5 | 54.3 | 54.6 |
//| 5 | 73.3 | 73.2 | 72.8 | 70.5 | 69.2 | 68.8 | 68.7 |
//| 6 | 84.6 | 84.2 | 84.0 | 83.0 | 81.0 | 80.8 | 81.2 |
//| 7 | 92.3 | 91.9 | 92.0 | 91.6 | 90.4 | 90.3 | 90.2 |
//| 8 | 96.4 | 96.9 | 97.1 | 96.9 | 96.2 | 96.5 | 96.0 |
//| 9 | 98.9 | 99.0 | 99.2 | 99.3 | 98.5 | 99.0 | 98.8 |
//| 10 | 99.9 | 99.8 | 99.9 | 99.8 | 99.8 | 99.8 | 99.8 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
//| 12 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |


//沙奈朵[100,000], 大木博士 > 精靈球
//|  | 2 | 3 | 4 | 5 | 6 |
//| --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 3 | 39.5 | 37.2 | 35.3 | 33.7 | 32.4 |
//| 4 | 52.7 | 50.6 | 48.9 | 47.5 | 46.1 |
//| 5 | 65.4 | 63.7 | 62.1 | 60.6 | 59.5 |
//| 6 | 76.8 | 75.7 | 74.5 | 73.3 | 72.3 |
//| 7 | 86.2 | 85.7 | 84.9 | 84.3 | 83.5 |
//| 8 | 93.2 | 93.2 | 93.0 | 92.6 | 92.2 |
//| 9 | 97.5 | 97.6 | 97.6 | 97.6 | 97.4 |
//| 10 | 99.4 | 99.5 | 99.5 | 99.5 | 99.4 |
//| 11 | 99.9 | 99.9 | 99.9 | 100.0 | 99.9 |
//| 12 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |

//寶石海星[100,000], 大木博士 > 精靈球
//|  | 2 | 3 | 4 | 5 | 6 |
//| --- | --- | --- | --- | --- | --- |
//| 0 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 1 | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
//| 2 | 56.5 | 53.4 | 50.8 | 48.4 | 47.1 |
//| 3 | 67.3 | 65.0 | 62.8 | 60.6 | 59.4 |
//| 4 | 76.4 | 74.8 | 72.8 | 71.2 | 69.9 |
//| 5 | 84.1 | 83.1 | 81.7 | 80.3 | 79.4 |
//| 6 | 90.4 | 89.8 | 89.0 | 88.0 | 87.4 |
//| 7 | 94.9 | 94.7 | 94.3 | 93.9 | 93.5 |
//| 8 | 98.1 | 98.0 | 97.9 | 97.9 | 97.7 |
//| 9 | 99.5 | 99.6 | 99.6 | 99.5 | 99.4 |
//| 10 | 99.9 | 99.9 | 100.0 | 100.0 | 99.9 |
//| 11 | 100.0 | 100.0 | 100.0 | 100.0 | 100.0 |
